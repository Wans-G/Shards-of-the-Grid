- content_for :background_music, 'log_in.mp3'
%section.vh-100{ style: "background-image: url('#{image_path('login_register_background.jpg')}'); background-size: cover; background-position: center; height: 100vh; width: 100vw; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center;" }

  %div{ style: "background: rgba(0,0,0,0.8); padding:30px; border-radius:8px; width:400px; box-shadow:0px 4px 10px rgba(0,0,0,0.5);" }
    %div{ style: "text-align:center; margin-bottom:20px;" }
      %img{ src: image_path('logo.png'), alt:"Logo", style:"max-width:100px;" }
    %h1{ style:"color:#ECF0F1; text-align:center; margin-bottom:20px;" } Welcome, New Adventurer

    %audio{ id: "background-music", src:"/audio/log_in.mp3", preload:"auto", style:"display:none;" }

    .modal-overlay{ id: "modalOverlay", style: "display:block; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000;" }
      .modal-content{
        style:"position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.1); width:90%; max-width:400px; text-align:center;"
      }
        .modal-header{ style:"display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;" }
          %h2{ style:"margin:0; font-size:1.5em;" } Announcement
          %span{ id:"closeModal", style:"cursor:pointer; font-size:1.2em;" } &times;
        .modal-body
          %p Welcome, new adventurer! Enjoy 50% off all store gems until the end of 2024!
        .modal-footer
          %button{ id:"closeButton", style:"padding:5px 10px; background-color:#3498DB; color:white; border:none; border-radius:4px; cursor:pointer;" } Close

:javascript
  document.addEventListener("DOMContentLoaded", function() {
    var audio = document.getElementById('background-music');
    var closeModal = document.getElementById('closeModal');
    var closeButton = document.getElementById('closeButton');

    function playMusic() {
      audio.muted = false;
      audio.play().catch((err) => console.error('Audio playback error:', err));
    }

    audio.muted = true;
    audio.play().then(() => {
      console.log('Music is playing automatically in silent mode.');
    }).catch((err) => {
      console.error('Autoplay failed. Waiting for user interaction.', err);

      document.addEventListener('click', function enableSound() {
        playMusic();
        document.removeEventListener('click', enableSound);
      });
    });

    function closeAndRedirect() {
      window.location.href = '/login?play_music=true';
    }

    closeModal.addEventListener('click', closeAndRedirect);
    closeButton.addEventListener('click', closeAndRedirect);
  });

