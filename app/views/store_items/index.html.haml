-# app/views/store_items/index.html.haml

%section.store-page{ style: "position: relative; height: 100vh; background-image: url(#{image_path('store_background.png')}); background-repeat: no-repeat; background-position: center center; background-size: cover; color: #ECF0F1; font-family: sans-serif;" }
  / Navigation Bar
  %div.nav-container{ style: "position: relative; height: 80px; width: 100%; display: flex; align-items: center; justify-content: space-between;" }
    = render 'shared/navigation'

  %div.center-content{ style: "display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;" }
    %h1{ style: "font-size: 2.5rem; margin-bottom: 30px; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);" } STORE

    %div{ id: "overlay", style: "display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 999;" }
      = render 'shared/flash'

    %div{ id: "popup-purchase-shards", style: "display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; padding: 20px; background-color: rgba(0, 0, 0, 0.75); border: 1px solid #ccc; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 1000; border-radius: 10px;" }
      %h2{ style: "margin-bottom: 20px; color: #2C3E50; text-align: center;" } Purchase Shards
      %p{ style: "margin-bottom: 20px; color: #7F8C8D; text-align: center;" } Select a shard package to purchase.

      %div{ style: "display: flex; justify-content: space-around; align-items: center; gap: 20px; margin-bottom: 20px;" }
        %div.purchase-panel
          %img{ src: image_path('shards_normal.png'), alt: "50 Shards Icon", style: "width: 75px; height: 75px; margin-bottom: 10px;" }
          %strong $5.00 - 50 Shards
          %button{ class: "purchase-button", data: { package: "50 Shards for $5.00" }, style: "margin-left: 10px; padding: 5px 10px; background-color: #2ECC71; color: #fff; border: none; border-radius: 5px;" } Purchase

        %div.purchase-panel
          %img{ src: image_path('shards_medium.png'), alt: "50 Shards Icon", style: "width: 75px; height: 75px; margin-bottom: 10px;" }
          %strong $10.00 - 120 Shards
          %button{ class: "purchase-button", data: { package: "120 Shards for $10.00" }, style: "margin-left: 10px; padding: 5px 10px; background-color: #1ABC9C; color: #fff; border: none; border-radius: 5px;" } Purchase

        %div.purchase-panel
          %img{ src: image_path('shards_large.png'), alt: "50 Shards Icon", style: "width: 75px; height: 75px; margin-bottom: 10px;" }
          %strong $20.00 - 250 Shards
          %button{ class: "purchase-button", data: { package: "250 Shards for $20.00" }, style: "margin-left: 10px; padding: 5px 10px; background-color: #3498DB; color: #fff; border: none; border-radius: 5px;" } Purchase

      %button{ id: "close-popup-purchase", style: "margin-top: 20px; padding: 10px 20px; background-color: #DB4437; color: #fff; border: none; border-radius: 5px;" } Close

    %div{ id: "popup-confirm-purchase", style: "display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40%; padding: 20px; background-color: rgba(0, 0, 0, 0.75); border: 1px solid #ccc; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 1001;" }
      %h2 Confirm Your Purchase
      %p{ id: "confirmation-message" }
      %button{ id: "confirm-purchase", style: "margin-right: 10px; padding: 10px 20px; background-color: #2ECC71; color: #fff; border: none; border-radius: 5px;" } Confirm
      %button{ id: "cancel-purchase", style: "padding: 10px 20px; background-color: #DB4437; color: #fff; border: none; border-radius: 5px;" } Cancel

    %button{ id: "open-popup-purchase", style: "margin: 20px; padding: 10px; background-color: #2ECC71; color: #fff; border: none; border-radius: 5px;" }
      Purchase Shards

:javascript
  document.addEventListener("DOMContentLoaded", () => {
    const overlay = document.getElementById("overlay");

    // Pop-up buttons for purchase and confirmation
    const openPurchaseButton = document.getElementById("open-popup-purchase");
    const closePurchaseButton = document.getElementById("close-popup-purchase");
    const purchasePopup = document.getElementById("popup-purchase-shards");

    // Confirmation pop-up elements
    const confirmationPopup = document.getElementById("popup-confirm-purchase");
    const confirmPurchaseButton = document.getElementById("confirm-purchase");
    const cancelPurchaseButton = document.getElementById("cancel-purchase");
    const confirmationMessage = document.getElementById("confirmation-message");

    const closePopup = (popup) => {
      popup.style.display = "none";
      overlay.style.display = "none";
    };

    const openPopup = (popup) => {
      popup.style.display = "block";
      overlay.style.display = "block";
    };

    const openConfirmation = (packageInfo) => {
      // Set up the confirmation message dynamically
      confirmationMessage.textContent = `Are you sure you want to purchase ${packageInfo}?`;
      openPopup(confirmationPopup);
      closePopup(purchasePopup); // Close the purchase pop-up immediately after opening confirmation
    };

    // Open "Purchase Shards" pop-up
    openPurchaseButton.addEventListener("click", () => openPopup(purchasePopup));

    // Close "Purchase Shards" pop-up
    closePurchaseButton.addEventListener("click", () => closePopup(purchasePopup));

    // Open confirmation pop-up when a purchase button is clicked
    const purchaseButtons = document.querySelectorAll('.purchase-button');
    purchaseButtons.forEach(button => {
      button.addEventListener('click', (event) => {
        const packageInfo = event.target.getAttribute('data-package');
        openConfirmation(packageInfo);
      });
    });

    // Close pop-ups when clicking outside
    overlay.addEventListener("click", () => {
      closePopup(purchasePopup);
      closePopup(confirmationPopup);
    });

    // Confirm purchase (this could trigger a backend action in the future)
    confirmPurchaseButton.addEventListener("click", () => {
      console.log('Purchase confirmed!');
      // Here, you'd likely trigger a backend API call to process the purchase
      closePopup(confirmationPopup); // Close the confirmation
    });

    // Cancel purchase
    cancelPurchaseButton.addEventListener("click", () => {
      console.log('Purchase canceled.');
      closePopup(confirmationPopup); // Close the confirmation
    });
  });